<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyRent</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>EasyRent</h1>
        <div class="tabs">
            <button id="tab-all" class="active">Όλες οι Αγγελίες</button>
            <button id="tab-favorites">Αγαπημένα</button>
        </div>
    </header>

    <section id="filters">
        <label>Ελάχιστη τιμή:
            <input type="number" id="minPrice" min="0">
        </label>
        <label>Μέγιστη τιμή:
            <input type="number" id="maxPrice" min="0">
        </label>
        <button id="filterBtn">Φίλτρο</button>
    </section>

    <main id="listingContainer"></main>

    <script>
        const listingContainer = document.getElementById('listingContainer');
        const tabAll = document.getElementById('tab-all');
        const tabFav = document.getElementById('tab-favorites');
        const filterBtn = document.getElementById('filterBtn');

        let allListings = [];
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let currentTab = 'all';

        async function loadListings() {
            const res = await fetch('data.json');
            allListings = await res.json();
            renderListings(allListings);
        }

        function renderListings(list) {
            listingContainer.innerHTML = '';
            if (list.length === 0) {
                listingContainer.innerHTML = '<p>Δεν υπάρχουν διαθέσιμες αγγελίες.</p>';
                return;
            }
            list.forEach(item => {
                const div = document.createElement('div');
                div.classList.add('listing');
                div.innerHTML = `
                    <img src="${item.image}" alt="${item.title}">
                    <h3>${item.title}</h3>
                    <p>${item.price} €</p>
                    <button class="fav-btn">${favorites.includes(item.id) ? '♥' : '♡'}</button>
                `;
                div.querySelector('.fav-btn').addEventListener('click', () => toggleFavorite(item.id));
                listingContainer.appendChild(div);
            });
        }

        function toggleFavorite(id) {
            if (favorites.includes(id)) {
                favorites = favorites.filter(f => f !== id);
            } else {
                favorites.push(id);
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            if (currentTab === 'favorites') {
                renderListings(allListings.filter(item => favorites.includes(item.id)));
            } else {
                renderListings(allListings);
            }
        }

        tabAll.addEventListener('click', () => {
            currentTab = 'all';
            tabAll.classList.add('active');
            tabFav.classList.remove('active');
            renderListings(allListings);
        });

        tabFav.addEventListener('click', () => {
            currentTab = 'favorites';
            tabFav.classList.add('active');
            tabAll.classList.remove('active');
            renderListings(allListings.filter(item => favorites.includes(item.id)));
        });

        filterBtn.addEventListener('click', () => {
            const min = parseFloat(document.getElementById('minPrice').value) || 0;
            const max = parseFloat(document.getElementById('maxPrice').value) || Infinity;
            const filtered = allListings.filter(item => item.price >= min && item.price <= max);
            if (currentTab === 'favorites') {
                renderListings(filtered.filter(item => favorites.includes(item.id)));
            } else {
                renderListings(filtered);
            }
        });

        loadListings();
    </script>
</body>
</html>

